# Prometheus alerting rules for Ghostwarden
groups:
  - name: ghostwarden
    rules:
      - alert: GhostwardenDown
        expr: up{job="ghostwarden"} == 0
        for: 30s
        labels:
          severity: critical
        annotations:
          summary: "Ghostwarden service is down"
          description: "Ghostwarden has been down for more than 30 seconds."

      - alert: HighErrorRate
        expr: rate(ghostwarden_errors_total[5m]) > 0.1
        for: 2m
        labels:
          severity: warning
        annotations:
          summary: "High error rate in Ghostwarden"
          description: "Ghostwarden is experiencing {{ $value }} errors per second."

      - alert: LongSyncDuration
        expr: ghostwarden_sync_duration_seconds > 30
        for: 1m
        labels:
          severity: warning
        annotations:
          summary: "Ghostwarden sync taking too long"
          description: "Last sync took {{ $value }} seconds, which is unusually long."

      - alert: ManyBannedIPs
        expr: ghostwarden_banned_ips_current > 1000
        for: 5m
        labels:
          severity: info
        annotations:
          summary: "Large number of banned IPs"
          description: "Currently {{ $value }} IP addresses are banned."

      - alert: NoRecentSync
        expr: time() - ghostwarden_last_sync_timestamp > 300
        for: 2m
        labels:
          severity: warning
        annotations:
          summary: "Ghostwarden hasn't synced recently"
          description: "Last sync was {{ $value }} seconds ago."
